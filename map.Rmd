---
title: "Map"
author: "Diana LaScala-Gruenewald"
date: "7/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Install packages

```{r}
# require() is like library() except it returns F if the package is missing
if (!require(librarian)){
  install.packages('librarian')
  library(librarian)
}

# librarian::shelf() is like library() except it installs a package if it's missing
# even from GitHub if the owner/repo are included
shelf(
  NOAA-EDAB/ecodata,
  sf, 
  quiet=T
)
```

## Get spatial data

These data are part of an ecological indicator status data set generated by NOAA. It gives the Ecological Production Units for a set of ocean regions in the western Atlantic: Mid-Atlantic Bight (MAB), Georges Bank (GB), Gulf of Maine (GOM), and Scotian Shelf (SS).

```{r}
# Look at the structure of what we downloaded
ecodata::epu_sf
```

```{r}
# Set the crs to WGS84
epu_sf <- ecodata::epu_sf %>%
  st_transform(4326)

# Plot all data (all three columns except for the geometry column)
plot(epu_sf)
```

## Static maps

```{r}
# Plot just the EPU data
plot(epu_sf['EPU'])
```

So, where in the world is this? We can add a basemap to find out.

## Interactive maps

```{r}
# Make sure mapview is installed and load it
shelf(mapview, quiet=T)

# Plot
mapview(epu_sf)
```

```{r}
shelf(leaflet, quiet=T)

leaflet() %>%
  # Add tiles
  addProviderTiles(providers$Esri.OceanBasemap) %>%
  # Add data
  addPolygons(data = epu_sf)
```

## Resources
- [xtractomatic](https://rdrr.io/cran/xtractomatic/)
  - [demo](https://ioos.github.io/notebooks_demos/notebooks/2017-08-01-xtractoR/)
- [leafsync](https://github.com/r-spatial/leafsync)
- [marmap](https://cran.r-project.org/web/packages/marmap/index.html)